<query-editor-row query-ctrl="ctrl" can-collapse="false">
  <div class="gf-form">
    <label class="gf-form-label width-11 pointer" for="in-query-{{ctrl.target.refId}}">Query</label>
    <input id="in-query-{{ctrl.target.refId}}" class="gf-form-input" type="text" ng-model='ctrl.target.entityQuery' ng-class="ctrl.target.queryIsValid ? 'ng-valid' : 'ng-invalid'"
      ng-model-options='{ debounce: 200 }' ng-change="ctrl.onFilterChange(true)" placeholder="Please Specify">
    </input>
    <info-popover mode="right-absolute">
      <p>Specify a query for the entities you wish to plot. Use the dynamic focus syntax:
        <a href="https://docs.instana.io/core_concepts/dynamic_focus/#syntax">https://docs.instana.io/core_concepts/dynamic_focus/#syntax</a>
      </p>
    </info-popover>
  </div>

  <gf-form-switch class="gf-form" label="New Application Model" label-class="width-11" checked="ctrl.target.newApplicationModelEnabled" on-change="ctrl.onFilterChange(true)"></gf-form-switch>

  <div class="gf-form">
    <label class="gf-form-label width-11 pointer" for="in-type-{{ctrl.target.refId}}">Type</label>
    <div class="gf-form-select-wrapper width-18 gf-form-select-wrapper--has-help-icon">
      <select  id="in-type-{{ctrl.target.refId}}" class="gf-form-input ng-pristine ng-valid ng-not-empty ng-touched" ng-model="ctrl.target.entityType" ng-change="ctrl.onEntityTypeSelect(true)"
        ng-options="f as ctrl.metricsDefinition[f].label for f in ctrl.uniqueEntityTypes">
        <option value="" disabled selected>{{ctrl.entitySelectionText}}</option>
      </select>
      <info-popover mode="right-absolute">
        <p>Select an entity type for a list of available metrics.</p>
      </info-popover>
    </div>
  </div>

  <div class="gf-form">
    <label class="gf-form-label width-11 pointer" for="in-metric-{{ctrl.target.refId}}">Metric</label>
    <div class="gf-form-select-wrapper width-18 gf-form-select-wrapper--has-help-icon">
      <select  id="in-metric-{{ctrl.target.refId}}" class="gf-form-input ng-pristine ng-valid ng-not-empty ng-touched" ng-model="ctrl.target.metric" ng-change="ctrl.onMetricSelect()"
        ng-options="f as f.label + ' (' + f.key + ')' for f in ctrl.availableMetrics">
        <option value="" disabled selected>{{ctrl.metricSelectionText}}</option>
      </select>
      <info-popover mode="right-absolute">
        <p>Select the metric you wish to plot.</p>
      </info-popover>
    </div>
  </div>
</query-editor-row>
